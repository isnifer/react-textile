!function(t,a,e){var s=document.querySelector(".main"),i="data.json",r=a.createClass({displayName:"Main",getInitialState:function(){return{data:[]}},loadData:function(){e.ajax({url:this.props.url,dataType:"json",success:function(t){this.setState({data:t})}.bind(this),error:function(t,a,e){console.error(t,a,e)}})},sizeCallback:function(t,a,e){var s=(t.props.title,t.props.parentTitle),i=this.state.data,r=i.findIndex(function(t){return t.title==s});i[r].count+=a,i[r].value+=e,this.setState({data:i}),console.log(this.state.data)},componentDidMount:function(){this.loadData()},render:function(){return a.DOM.div({className:"main__wrapper"},l({data:this.state.data}),c({data:this.state.data,sizeCallback:this.sizeCallback}))}}),l=a.createClass({displayName:"Sidebar",render:function(){var t=this.props.data.reduce(function(t,a){return t+a.value},0),e=this.props.data.map(function(t,a){return n({url:"#/product/"+a,title:t.title,value:t.value,count:t.count})});return a.DOM.div({className:"sidebar"},a.DOM.div({className:"sidebar__list"},e),a.DOM.div({className:"sidebar__all"},"Всего на ",t," руб."),a.DOM.button({type:"button",className:"sidebar__btn btn btn-success"},"Отправить заказ менеджеру"))}}),n=a.createClass({displayName:"SidebarItem",render:function(){return a.DOM.div({className:"sidebar__item"},a.DOM.a({className:"sidebar__link",href:this.props.url},this.props.title),a.DOM.div({className:"sidebar__choose"},"Выбрано ",this.props.count," комплектов на ",this.props.value," руб."))}}),c=a.createClass({displayName:"Content",render:function(){var t=this,e=this.props.data.map(function(a){return o({sizeCallback:t.props.sizeCallback,title:a.title,variants:a.variants})});return a.DOM.div({className:"content"},e)}}),o=a.createClass({displayName:"Product",render:function(){var t=this,e=this.props.variants.map(function(a){return u({title:a.title,sizes:a.sizes,parentTitle:t.props.title,sizeCallback:t.props.sizeCallback})}),s=this.props.variants[0].sizes.map(function(t){return p({title:t.title})});return a.DOM.div({className:"product"},a.DOM.div({className:"product__stat g-clf"},a.DOM.div({className:"product__title"},this.props.title),a.DOM.div({className:"product__overall"},a.DOM.div({className:"product__overall-title"},"Общее количество:"),s)),a.DOM.div({className:"product__variants"},e))}}),p=a.createClass({displayName:"ProductOverallItem",render:function(){return a.DOM.div({className:"product__overall-item"},a.DOM.div({className:"product__overall-item-title"},this.props.title),a.DOM.div({className:"product__overall-item-count"},"шт"))}}),u=a.createClass({displayName:"Variant",render:function(){var t=this,e=this.props.sizes.map(function(a){return d({title:a.title,price:a.price,active:a.active,parentTitle:t.props.parentTitle,sizeCallback:t.props.sizeCallback})});return a.DOM.div({className:"variant"},a.DOM.div({className:"variant__title"},this.props.title),a.DOM.div({className:"variant__sizes g-clf"},e))}}),d=a.createClass({displayName:"VariantSize",getInitialState:function(){return{count:0,value:0}},changeValue:function(t){this.setState({count:t.target.value,value:t.target.value*this.props.price}),this.props.sizeCallback(this,t.target.value,t.target.value*this.props.price)},plusValue:function(){var t=this.state.count+1,a=t*this.props.price;this.setState({count:t,value:a}),this.props.sizeCallback(this,1,this.props.price)},minusValue:function(){var t=0===this.state.count?0:this.state.count-1,a=t*this.props.price;this.setState({count:t,value:a}),this.props.sizeCallback(this,0===this.state.count?0:-1,0===this.state.count?0:-this.props.price)},render:function(){return a.DOM.div({className:this.props.active?"size":"size size_state_inactive"},a.DOM.p({className:"size__title"},this.props.title),a.DOM.p({className:"size__price"},this.props.price,".-"),a.DOM.p({className:"size__counter g-clf"},a.DOM.i({className:"size__changer glyphicon glyphicon-minus",onClick:this.minusValue}),a.DOM.input({type:"text",className:"size__input",maxLength:"4",value:this.state.count,disabled:!this.props.active,onChange:this.changeValue}),a.DOM.i({className:"size__changer glyphicon glyphicon-plus",onClick:this.plusValue})),a.DOM.p({className:"size__value"},this.state.value,".-"))}});a.renderComponent(r({url:i}),s)}(window,window.React,window.jQuery);